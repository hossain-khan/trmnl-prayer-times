{% comment %}
  FULL LAYOUT - Prayer Times Display
  Responsive flexbox layout that scales to 100% height/width
  Prayer times auto-fit to available space
{% endcomment %}

{% assign prayer_data = data %}
{% assign timings = prayer_data.timings %}
{% assign gregorian = prayer_data.date.gregorian %}
{% assign hijri = prayer_data.date.hijri %}
{% assign custom_title = trmnl.plugin_settings.custom_fields_values.custom_title %}
{% assign show_hijri = trmnl.plugin_settings.custom_fields_values.show_hijri_date %}

<div class="layout layout--col layout--stretch">
  {% if prayer_data and timings.Fajr %}
    <div class="flex flex--col flex--stretch h--full p--2" style="gap: 0.5rem;">
      {% comment %} Date Section - Top of screen {% endcomment %}
      <div class="flex flex--row gap--medium flex--center-x no-shrink">
        <div class="flex flex--col gap--xsmall text--center">
          <span class="label">{{ gregorian.weekday.en }}</span>
          <span class="value value--xlarge lg:value--xxxlarge">{{ gregorian.day }}</span>
          <span class="title title--large lg:title--xlarge">{{ gregorian.month.en }}</span>
        </div>
        {% if show_hijri %}
        <div class="divider" style="height: 2rem;"></div>
        <div class="flex flex--col gap--xsmall text--center">
          <span class="label">{{ hijri.month.en }}</span>
          <span class="value value--xlarge lg:value--xxxlarge">{{ hijri.day }}</span>
          <span class="description md:label">{{ hijri.year }}</span>
        </div>
        {% endif %}
      </div>

      {% comment %} Prayer Times - Each row stretches to fill available height {% endcomment %}
      <div class="flex flex--col flex--stretch-y gap--small" style="flex: 1;">
        {% comment %} Fajr {% endcomment %}
        <div class="flex flex--row flex--center-y flex--stretch-x" style="flex: 1; padding: 0.5rem 0;">
          <span class="title title--medium md:title--large lg:title--xlarge">Fajr</span>
          <span class="value value--xxxlarge md:value--xxxlarge lg:value--xxxlarge value--tnums" 
                data-value-fit="true" 
                data-value-fit-max-height="120"
                style="flex: 1; text-align: right;">{{ timings.Fajr }}</span>
        </div>

        {% comment %} Dhuhr {% endcomment %}
        <div class="flex flex--row flex--center-y flex--stretch-x" style="flex: 1; padding: 0.5rem 0;">
          <span class="title title--medium md:title--large lg:title--xlarge">Dhuhr</span>
          <span class="value value--xxxlarge md:value--xxxlarge lg:value--xxxlarge value--tnums" 
                data-value-fit="true" 
                data-value-fit-max-height="120"
                style="flex: 1; text-align: right;">{{ timings.Dhuhr }}</span>
        </div>

        {% comment %} Asr {% endcomment %}
        <div class="flex flex--row flex--center-y flex--stretch-x" style="flex: 1; padding: 0.5rem 0;">
          <span class="title title--medium md:title--large lg:title--xlarge">Asr</span>
          <span class="value value--xxxlarge md:value--xxxlarge lg:value--xxxlarge value--tnums" 
                data-value-fit="true" 
                data-value-fit-max-height="120"
                style="flex: 1; text-align: right;">{{ timings.Asr }}</span>
        </div>

        {% comment %} Maghrib {% endcomment %}
        <div class="flex flex--row flex--center-y flex--stretch-x" style="flex: 1; padding: 0.5rem 0;">
          <span class="title title--medium md:title--large lg:title--xlarge">Maghrib</span>
          <span class="value value--xxxlarge md:value--xxxlarge lg:value--xxxlarge value--tnums" 
                data-value-fit="true" 
                data-value-fit-max-height="120"
                style="flex: 1; text-align: right;">{{ timings.Maghrib }}</span>
        </div>

        {% comment %} Isha {% endcomment %}
        <div class="flex flex--row flex--center-y flex--stretch-x" style="flex: 1; padding: 0.5rem 0;">
          <span class="title title--medium md:title--large lg:title--xlarge">Isha</span>
          <span class="value value--xxxlarge md:value--xxxlarge lg:value--xxxlarge value--tnums" 
                data-value-fit="true" 
                data-value-fit-max-height="120"
                style="flex: 1; text-align: right;">{{ timings.Isha }}</span>
        </div>
      </div>
    </div>
  {% else %}
    {% render "error_state", size: "full" %}
  {% endif %}
</div>

{% render "title_bar", custom_title: custom_title, trmnl: trmnl %}
